<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ã‚¸ãƒ£ã‚°ãƒ©ãƒ¼ è¨­å®šæ¨æ¸¬ãƒ„ãƒ¼ãƒ«</title>

<style>
body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif;
    background: #f2f2f2;
    margin: 0;
    padding: 15px;
}
.container {
    max-width: 480px;
    margin: auto;
}
h1 {
    text-align: center;
    font-size: 22px;
    color: #d40000;
}
label {
    display: block;
    margin-top: 15px;
    font-size: 16px;
}
select, input {
    width: 100%;
    padding: 12px;
    font-size: 18px;
    margin-top: 5px;
}
button {
    width: 100%;
    margin-top: 15px;
    padding: 14px;
    font-size: 18px;
    background: #d40000;
    color: #fff;
    border: none;
    border-radius: 6px;
}
.result {
    margin-top: 20px;
    padding: 15px;
    border-radius: 8px;
    font-size: 16px;
    line-height: 1.6;
}
.green { background:#e6ffe6; border:2px solid #2ecc71; }
.yellow { background:#fffbe6; border:2px solid #f1c40f; }
.red { background:#ffe6e6; border:2px solid #e74c3c; }
.percent { font-size:24px; }
.setting { font-weight:bold; }
.hitlist {
    margin-top: 10px;
    font-size: 14px;
    background: #fff;
    padding: 10px;
    border-radius: 6px;
}
</style>
</head>

<body>
<div class="container">

<h1>ğŸ° ã‚¸ãƒ£ã‚°ãƒ©ãƒ¼è¨­å®šæ¨æ¸¬</h1>

<label>æ©Ÿç¨®é¸æŠ</label>
<select id="type">
    <option value="im">ã‚¢ã‚¤ãƒ ã‚¸ãƒ£ã‚°ãƒ©ãƒ¼EX</option>
    <option value="my">ãƒã‚¤ã‚¸ãƒ£ã‚°ãƒ©ãƒ¼â…¤</option>
    <option value="funky">ãƒ•ã‚¡ãƒ³ã‚­ãƒ¼ã‚¸ãƒ£ã‚°ãƒ©ãƒ¼2</option>
    <option value="gogo">ã‚´ãƒ¼ã‚´ãƒ¼ã‚¸ãƒ£ã‚°ãƒ©ãƒ¼3</option>
    <option value="happy">ãƒãƒƒãƒ”ãƒ¼ã‚¸ãƒ£ã‚°ãƒ©ãƒ¼Vâ…¢</option>
    <option value="miracle">ã‚¹ãƒ¼ãƒ‘ãƒ¼ãƒŸãƒ©ã‚¯ãƒ«ã‚¸ãƒ£ã‚°ãƒ©ãƒ¼</option>
    <option value="girls">ã‚¸ãƒ£ã‚°ãƒ©ãƒ¼ã‚¬ãƒ¼ãƒ«ã‚ºSS</option>
</select>

<label>ç·å›è»¢æ•°</label>
<input type="number" id="games">

<label>BIGå›æ•°</label>
<input type="number" id="big">

<label>REGå›æ•°</label>
<input type="number" id="reg">

<hr>

<label>ãƒœãƒ¼ãƒŠã‚¹å½“é¸å…¥åŠ›</label>
<input type="number" id="hitGame" placeholder="ä½•ã‚²ãƒ¼ãƒ ç›®ï¼Ÿ">
<select id="hitType">
    <option value="BIG">BIG</option>
    <option value="REG">REG</option>
</select>
<button onclick="addHit()">å½“é¸ã‚’è¿½åŠ </button>

<div id="hitList" class="hitlist"></div>

<button onclick="calc()">è¨­å®šã‚’æ¨æ¸¬</button>

<div class="result" id="result"></div>

</div>

<script>
let hits = [];

function addHit() {
    const game = Number(document.getElementById("hitGame").value);
    const type = document.getElementById("hitType").value;
    if (game <= 0) return;

    hits.push({ game, type });
    document.getElementById("hitGame").value = "";

    document.getElementById("hitList").innerHTML =
        hits.map((h, i) => `${i+1}. ${h.game}G ${h.type}`).join("<br>");
}

function calc() {
    const type = document.getElementById("type").value;
    const g = Number(games.value);
    const b = Number(big.value);
    const r = Number(reg.value);

    if (g <= 0 || b + r <= 0) {
        result.innerText = "æ•°å€¤ã‚’æ­£ã—ãå…¥åŠ›ã—ã‚";
        return;
    }

    const bigRate = g / b;
    const regRate = g / r;
    const totalRate = g / (b + r);

    let percent = 0;

    const regTable = {
        im: [255, 275, 295],
        my: [240, 260, 280],
        funky: [255, 270, 290],
        gogo: [260, 280, 300],
        happy: [255, 275, 295],
        miracle: [265, 285, 305],
        girls: [250, 270, 290]
    };

    const t = regTable[type];
    if (regRate <= t[0]) percent += 40;
    else if (regRate <= t[1]) percent += 30;
    else if (regRate <= t[2]) percent += 20;

    if (totalRate <= 127) percent += 40;
    else if (totalRate <= 130) percent += 30;
    else if (totalRate <= 135) percent += 20;
    else if (totalRate <= 145) percent += 10;

    if (g >= 7000) percent += 20;
    else if (g >= 5000) percent += 10;
    else if (g < 3000) percent -= 20;

    if (hits.length >= 3) {
        const avg = hits.reduce((s, h) => s + h.game, 0) / hits.length;
        const deep = hits.filter(h => h.game >= 400).length;
        const regRatio = hits.filter(h => h.type === "REG").length / hits.length;

        if (avg <= 150) percent += 15;
        else if (avg >= 300) percent -= 10;

        if (deep >= 2) percent -= 10;
        if (regRatio >= 0.4) percent += 10;
    }

    percent = Math.max(0, Math.min(95, percent));

    let state = "red", stateText = "ğŸ”´ å±é™º";
    if (percent >= 60) { state="green"; stateText="ğŸŸ¢ ç¶šè¡Œ"; }
    else if (percent >= 30) { state="yellow"; stateText="ğŸŸ¡ æ§˜å­è¦‹"; }

    let setting =
        percent >= 75 ? "è¨­å®š6æ¿ƒåš" :
        percent >= 60 ? "è¨­å®š5ã€œ6" :
        percent >= 45 ? "è¨­å®š4ã€œ5" :
        percent >= 30 ? "è¨­å®š3ã€œ4" : "ä½è¨­å®šå¯„ã‚Š";

    const avgHit = hits.length
        ? (hits.reduce((s, h) => s + h.game, 0) / hits.length).toFixed(1)
        : "-";

    result.className = `result ${state}`;
    result.innerHTML =
        `BIGï¼š1/${bigRate.toFixed(1)}<br>` +
        `REGï¼š1/${regRate.toFixed(1)}<br>` +
        `åˆç®—ï¼š1/${totalRate.toFixed(1)}<hr>` +
        `å¹³å‡åˆå½“ã‚Šï¼š${avgHit}G<br>` +
        `è¨­å®š6æœŸå¾…åº¦ï¼š<span class="percent">${percent}%</span><br>` +
        `åˆ¤å®šï¼š<span class="setting">${setting}</span><br>` +
        `çŠ¶æ…‹ï¼š${stateText}`;
}
</script>

</body>
</html>
